<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Blue Cover ‚Äî Portail Courtier Partenaire</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700;800&family=Source+Sans+3:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{--yale:#243F74;--lapis:#0861A8;--oxford:#1A2F53;--cadet:#4B8BAD;--opal:#A8C5B8;--onyx:#3F3F41;--cream:#F8FAFB;--green:#059669;--red:#DC2626;--amber:#D97706;--fd:'Playfair Display',Georgia,serif;--fb:'Source Sans 3','Segoe UI',sans-serif}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
body{font-family:var(--fb);color:var(--onyx);line-height:1.6;background:var(--cream)}
.badge{font-size:11px;font-weight:700;padding:3px 10px;border-radius:6px;display:inline-block}
.badge-quoted{color:var(--green);background:#ECFDF5}.badge-submitted{color:var(--lapis);background:#EFF6FF}.badge-quoting{color:var(--amber);background:#FFFBEB}.badge-bound{color:var(--yale);background:#EEF2FF}.badge-active{color:var(--green);background:#ECFDF5}.badge-renewal{color:var(--amber);background:#FFFBEB}.badge-paid{color:var(--green);background:#ECFDF5}.badge-pending{color:var(--amber);background:#FFFBEB}.badge-received{color:var(--green);background:#ECFDF5}
#loginPage{display:flex;min-height:100vh}
.login-left{flex:1;background:linear-gradient(160deg,var(--oxford) 0%,var(--yale) 60%,var(--lapis) 100%);padding:60px 56px;display:flex;flex-direction:column;justify-content:center;position:relative;overflow:hidden}
.login-left::before{content:'';position:absolute;top:-100px;right:-100px;width:400px;height:400px;border-radius:50%;background:rgba(255,255,255,.03)}
.login-content{position:relative;z-index:2;max-width:480px}
.login-right{width:460px;display:flex;flex-direction:column;justify-content:center;padding:60px 48px;background:white}
.login-form-box{max-width:360px;margin:0 auto;width:100%}
#sidebar{width:240px;background:var(--oxford);min-height:100vh;padding:24px 0;display:flex;flex-direction:column;position:fixed;left:0;top:0;bottom:0;z-index:50}
.sidebar-logo{padding:0 20px;margin-bottom:36px;display:flex;align-items:center;gap:10px}
.sidebar-logo-icon{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--lapis),var(--cadet));display:flex;align-items:center;justify-content:center;color:white;font-weight:800;font-size:14px;font-family:var(--fd)}
.nav-item{width:100%;display:flex;align-items:center;gap:12px;padding:12px 20px;border:none;background:transparent;color:rgba(255,255,255,.5);font-size:14px;cursor:pointer;text-align:left;border-left:3px solid transparent;font-family:var(--fb);transition:all .2s}
.nav-item:hover{color:rgba(255,255,255,.7);background:rgba(255,255,255,.03)}
.nav-item.active{background:rgba(255,255,255,.1);color:white;font-weight:600;border-left-color:var(--opal)}
.sidebar-footer{padding:0 20px;border-top:1px solid rgba(255,255,255,.08);padding-top:16px;margin-top:auto}
#appPage{display:none}
#mainContent{margin-left:240px;padding:32px 40px}
.card{background:white;border-radius:16px;border:1px solid #E8ECF0}
.stat-card{padding:24px;position:relative;overflow:hidden}
.stat-card .bar{position:absolute;top:0;left:0;right:0;height:3px}
.stat-val{font-size:28px;font-weight:700;color:var(--oxford);font-family:var(--fd);margin:8px 0 4px}
.stat-label{font-size:13px;font-weight:600;color:var(--onyx);margin-bottom:4px}
.stat-sub{font-size:12px;color:var(--cadet)}
table{width:100%;border-collapse:collapse;font-size:14px}
th{padding:12px 16px;text-align:left;font-size:12px;font-weight:600;color:var(--cadet);text-transform:uppercase;letter-spacing:.05em;background:#F8FAFB}
td{padding:14px 16px;border-top:1px solid #F1F5F9}
tr.clickable:hover{background:#FAFBFC;cursor:pointer}
.form-input{width:100%;padding:12px 16px;border-radius:10px;border:1px solid #E2E8F0;font-size:14px;font-family:var(--fb);outline:none;transition:all .2s;background:white;box-sizing:border-box}
.form-input:focus{border-color:var(--lapis);box-shadow:0 0 0 3px rgba(8,97,168,.1)}
.form-label{font-size:13px;font-weight:600;color:var(--onyx);display:block;margin-bottom:6px}
.form-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.full{grid-column:1/-1}
.btn{padding:12px 28px;border-radius:10px;font-size:14px;font-weight:700;cursor:pointer;border:none;font-family:var(--fb);transition:all .3s}
.btn-primary{background:linear-gradient(135deg,var(--yale),var(--lapis));color:white}
.btn-primary:hover{box-shadow:0 4px 16px rgba(8,97,168,.3)}
.btn-secondary{background:#F1F5F9;color:var(--onyx)}
.btn-outline{background:white;border:2px solid var(--yale);color:var(--yale)}
.progress-bar{display:flex;gap:4px;margin-bottom:28px}
.progress-bar div{flex:1;height:4px;border-radius:2px;background:#E2E8F0;transition:background .4s}
.progress-bar div.active{background:linear-gradient(90deg,var(--yale),var(--lapis))}
.ocr-zone{border:2px dashed #CBD5E1;border-radius:16px;padding:32px;text-align:center;margin-bottom:24px;background:rgba(36,63,116,.02);transition:all .3s;cursor:pointer}
.ocr-zone.dragover{border-color:var(--lapis);background:rgba(8,97,168,.04)}
.highlight{border-color:var(--opal)!important;background:rgba(168,197,184,.06)!important}
@keyframes spin{to{transform:rotate(360deg)}}
.spinner{width:24px;height:24px;border:3px solid rgba(8,97,168,.15);border-top-color:var(--lapis);border-radius:50%;animation:spin .8s linear infinite;display:inline-block}
.page-view{display:none}.page-view:first-child{display:block}
@media(max-width:900px){.login-left{display:none}.login-right{width:100%}#sidebar{width:60px}.nav-item span:last-child,.sidebar-footer p,.sidebar-logo div:last-child{display:none}.nav-item{justify-content:center;padding:12px 0}#mainContent{margin-left:60px;padding:24px 16px}.form-grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<!-- LOGIN PAGE -->
<div id="loginPage">
  <div class="login-left">
    <div class="login-content">
      <div style="display:inline-flex;align-items:center;gap:10px;margin-bottom:32px">
        <div style="width:40px;height:40px;border-radius:12px;background:rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center;color:white;font-weight:800;font-size:16px;font-family:var(--fd)">BC</div>
        <span style="font-size:16px;font-weight:700;color:white">Blue Cover</span>
      </div>
      <h1 style="font-size:34px;font-weight:700;color:white;font-family:var(--fd);line-height:1.2;margin-bottom:16px">G√©n√©rez des commissions<br>sur le yacht,<br><span style="background:linear-gradient(90deg,#A8C5B8,#4B8BAD);-webkit-background-clip:text;-webkit-text-fill-color:transparent">sans l'expertise technique.</span></h1>
      <p style="font-size:16px;color:rgba(255,255,255,.65);line-height:1.7;margin-bottom:36px">Blue Cover place les risques yachting aupr√®s de ses assureurs partenaires. Vous apportez le client, nous faisons le reste. Vous touchez <strong style="color:white">10% de commission</strong> sur chaque police.</p>
      <div style="background:rgba(255,255,255,.08);border-radius:16px;padding:24px;border:1px solid rgba(255,255,255,.1);margin-bottom:28px">
        <p style="font-size:13px;font-weight:700;color:rgba(255,255,255,.5);text-transform:uppercase;letter-spacing:.08em;margin-bottom:16px">üí∞ Exemples de commissions</p>
        <table style="width:100%;border-collapse:collapse">
          <thead><tr><th style="padding:0 0 10px;text-align:left;font-size:11px;font-weight:600;color:rgba(255,255,255,.4);text-transform:uppercase;background:none">Navire</th><th style="padding:0 0 10px;text-align:left;font-size:11px;font-weight:600;color:rgba(255,255,255,.4);background:none">Valeur</th><th style="padding:0 0 10px;text-align:left;font-size:11px;font-weight:600;color:rgba(255,255,255,.4);background:none">Prime</th><th style="padding:0 0 10px;text-align:right;font-size:11px;font-weight:600;color:rgba(255,255,255,.4);background:none">Votre commission</th></tr></thead>
          <tbody>
            <tr style="border-top:1px solid rgba(255,255,255,.06)"><td style="padding:10px 0;font-size:13px;color:rgba(255,255,255,.8)">Motor Yacht 24m</td><td style="padding:10px 0;font-size:13px;color:rgba(255,255,255,.5)">‚Ç¨1,500,000</td><td style="padding:10px 0;font-size:13px;color:rgba(255,255,255,.5)">‚Ç¨18,000</td><td style="padding:10px 0;font-size:15px;font-weight:700;color:#A8C5B8;text-align:right">‚Ç¨1,800</td></tr>
            <tr style="border-top:1px solid rgba(255,255,255,.06)"><td style="padding:10px 0;font-size:13px;color:rgba(255,255,255,.8)">Sailing Yacht 32m</td><td style="padding:10px 0;font-size:13px;color:rgba(255,255,255,.5)">‚Ç¨4,200,000</td><td style="padding:10px 0;font-size:13px;color:rgba(255,255,255,.5)">‚Ç¨42,000</td><td style="padding:10px 0;font-size:15px;font-weight:700;color:#A8C5B8;text-align:right">‚Ç¨4,200</td></tr>
            <tr style="border-top:1px solid rgba(255,255,255,.06)"><td style="padding:10px 0;font-size:13px;color:rgba(255,255,255,.8)">Superyacht 45m</td><td style="padding:10px 0;font-size:13px;color:rgba(255,255,255,.5)">‚Ç¨12,000,000</td><td style="padding:10px 0;font-size:13px;color:rgba(255,255,255,.5)">‚Ç¨142,000</td><td style="padding:10px 0;font-size:15px;font-weight:700;color:#A8C5B8;text-align:right">‚Ç¨14,200</td></tr>
          </tbody>
        </table>
        <div style="margin-top:16px;padding-top:12px;border-top:1px solid rgba(255,255,255,.08);display:flex;justify-content:space-between;align-items:center">
          <span style="font-size:12px;color:rgba(255,255,255,.4)">5 clients yacht = environ</span>
          <span style="font-size:22px;font-weight:700;color:white;font-family:var(--fd)">‚Ç¨25,000+ / an</span>
        </div>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
        <div style="display:flex;gap:10px;padding:12px;border-radius:10px;background:rgba(255,255,255,.04)"><span style="font-size:18px">üìÑ</span><span style="font-size:12px;color:rgba(255,255,255,.6);line-height:1.5">Soumission en 2 min ‚Äî uploadez un Certificate of Registry</span></div>
        <div style="display:flex;gap:10px;padding:12px;border-radius:10px;background:rgba(255,255,255,.04)"><span style="font-size:18px">ü§ù</span><span style="font-size:12px;color:rgba(255,255,255,.6);line-height:1.5">Aucune expertise yachting requise ‚Äî nous g√©rons le placement</span></div>
        <div style="display:flex;gap:10px;padding:12px;border-radius:10px;background:rgba(255,255,255,.04)"><span style="font-size:18px">‚ö°</span><span style="font-size:12px;color:rgba(255,255,255,.6);line-height:1.5">Offres sous 48h ‚Äî acc√®s √† 10+ assureurs partenaires</span></div>
        <div style="display:flex;gap:10px;padding:12px;border-radius:10px;background:rgba(255,255,255,.04)"><span style="font-size:18px">üí∂</span><span style="font-size:12px;color:rgba(255,255,255,.6);line-height:1.5">Commission 10% ‚Äî vers√©e trimestriellement, suivie en temps r√©el</span></div>
      </div>
    </div>
  </div>
  <div class="login-right">
    <div class="login-form-box">
      <h2 style="font-size:22px;font-weight:700;color:var(--oxford);font-family:var(--fd);margin-bottom:4px">Connexion Partenaire</h2>
      <p style="font-size:14px;color:var(--cadet);margin-bottom:28px">Acc√©dez √† votre portail courtier Blue Cover.</p>
      <form onsubmit="event.preventDefault();doLogin()">
        <div style="margin-bottom:16px"><label class="form-label">Email professionnel</label><input class="form-input" type="email" placeholder="votre@email.com"></div>
        <div style="margin-bottom:24px"><label class="form-label">Mot de passe</label><input class="form-input" type="password"></div>
        <button type="submit" class="btn btn-primary" style="width:100%;padding:14px">Se connecter</button>
      </form>
      <div style="display:flex;align-items:center;gap:16px;margin:32px 0"><div style="flex:1;height:1px;background:#E8ECF0"></div><span style="font-size:12px;font-weight:600;color:var(--cadet)">PAS ENCORE PARTENAIRE ?</span><div style="flex:1;height:1px;background:#E8ECF0"></div></div>
      <div style="background:rgba(36,63,116,.04);border-radius:16px;padding:24px;border:1px solid rgba(36,63,116,.08)">
        <h3 style="font-size:16px;font-weight:700;color:var(--oxford);margin-bottom:8px">Devenez courtier apporteur</h3>
        <p style="font-size:13px;color:var(--cadet);line-height:1.6;margin-bottom:16px">Proposez l'assurance yacht √† vos clients et touchez 10% de commission sur chaque police, sans expertise technique.</p>
        <a href="mailto:partenaires@bluecover.ch?subject=Demande%20de%20partenariat%20courtier" class="btn btn-outline" style="display:block;text-align:center;text-decoration:none;width:100%;padding:12px;box-sizing:border-box">Nous contacter ‚Üí</a>
        <p style="font-size:11px;color:#94A3B8;margin-top:12px;text-align:center">partenaires@bluecover.ch ¬∑ R√©ponse sous 24h</p>
      </div>
      <button onclick="doLogin()" class="btn" style="width:100%;margin-top:16px;background:#F1F5F9;color:var(--cadet);font-weight:500;padding:10px;font-size:13px">üîç Voir la d√©mo du portail</button>
      <p style="text-align:center;margin-top:24px;font-size:11px;color:#CBD5E1">Blue Cover SA ¬∑ FINMA F01445236 ¬∑ ORIAS 24000663</p>
    </div>
  </div>
</div>
<!-- APP PAGE -->
<div id="appPage">
<div id="sidebar">
  <div class="sidebar-logo"><div class="sidebar-logo-icon">BC</div><div><span style="font-size:14px;font-weight:700;color:white">Blue Cover</span><br><span style="font-size:11px;color:rgba(255,255,255,.45)">Partner Portal</span></div></div>
  <div style="flex:1">
    <button class="nav-item active" data-page="dashboard" onclick="showPage('dashboard')"><span>üìä</span> <span>Dashboard</span></button>
    <button class="nav-item" data-page="submit" onclick="showPage('submit')"><span>‚ûï</span> <span>Soumettre un risque</span></button>
    <button class="nav-item" data-page="quotes" onclick="showPage('quotes')"><span>üìã</span> <span>Mes demandes</span></button>
    <button class="nav-item" data-page="policies" onclick="showPage('policies')"><span>üõ°Ô∏è</span> <span>Polices</span></button>
    <button class="nav-item" data-page="commissions" onclick="showPage('commissions')"><span>üí∂</span> <span>Commissions</span></button>
  </div>
  <div class="sidebar-footer">
    <p style="font-size:12px;color:rgba(255,255,255,.5);margin-bottom:2px">Jean-Marc Duval</p>
    <p style="font-size:11px;color:rgba(255,255,255,.3);margin-bottom:12px">Marine & Partners S√†rl</p>
    <button onclick="doLogout()" style="background:none;border:none;color:rgba(255,255,255,.4);font-size:13px;cursor:pointer;font-family:var(--fb)">‚¨Ö D√©connexion</button>
  </div>
</div>
<div id="mainContent">

<!-- DASHBOARD -->
<div id="page-dashboard" class="page-view" style="display:block">
  <h1 style="font-size:26px;font-weight:700;color:var(--oxford);font-family:var(--fd);margin-bottom:4px">Bonjour Jean-Marc</h1>
  <p style="font-size:15px;color:var(--cadet);margin-bottom:28px">Voici un aper√ßu de votre activit√© chez Blue Cover.</p>
  <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:32px">
    <div class="card stat-card"><div class="bar" style="background:var(--lapis)"></div><p class="stat-val">4</p><p class="stat-label">Demandes en cours</p><p class="stat-sub">2 en attente d'offres</p></div>
    <div class="card stat-card"><div class="bar" style="background:var(--opal)"></div><p class="stat-val">3</p><p class="stat-label">Polices actives</p><p class="stat-sub">1 renouvellement √† venir</p></div>
    <div class="card stat-card"><div class="bar" style="background:var(--yale)"></div><p class="stat-val">‚Ç¨18,930</p><p class="stat-label">Commissions YTD</p><p class="stat-sub">‚Ç¨1,890 en attente</p></div>
    <div class="card stat-card"><div class="bar" style="background:var(--cadet)"></div><p class="stat-val">10%</p><p class="stat-label">Taux de commission</p><p class="stat-sub">Sur toutes les polices</p></div>
  </div>
  <div style="display:grid;grid-template-columns:2fr 1fr;gap:20px">
    <div class="card" style="overflow:hidden">
      <div style="padding:16px 24px;border-bottom:1px solid #E8ECF0;display:flex;justify-content:space-between;align-items:center"><h3 style="font-size:15px;font-weight:700;color:var(--oxford)">Derni√®res demandes</h3><button onclick="showPage('quotes')" style="font-size:12px;color:var(--lapis);font-weight:600;background:none;border:none;cursor:pointer;font-family:var(--fb)">Voir tout ‚Üí</button></div>
      <div style="padding:14px 24px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #F1F5F9"><div><strong style="color:var(--oxford)">Azure Dream</strong><br><span style="font-size:12px;color:var(--cadet)">Motor Yacht ¬∑ 32m ¬∑ Laurent Mercier</span></div><div style="text-align:right"><span class="badge badge-quoted">Offres re√ßues</span><br><span style="font-size:11px;color:#94A3B8">QR-2025-0012</span></div></div>
      <div style="padding:14px 24px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #F1F5F9"><div><strong style="color:var(--oxford)">Stella Maris</strong><br><span style="font-size:12px;color:var(--cadet)">Sailing Yacht ¬∑ 24m ¬∑ Sophie Renard</span></div><div style="text-align:right"><span class="badge badge-submitted">Envoy√©</span><br><span style="font-size:11px;color:#94A3B8">QR-2025-0018</span></div></div>
      <div style="padding:14px 24px;display:flex;align-items:center;justify-content:space-between"><div><strong style="color:var(--oxford)">Calypso</strong><br><span style="font-size:12px;color:var(--cadet)">Motor Yacht ¬∑ 28m ¬∑ Isabella Fontana</span></div><div style="text-align:right"><span class="badge badge-quoting">En cotation</span><br><span style="font-size:11px;color:#94A3B8">QR-2025-0027</span></div></div>
    </div>
    <div class="card" style="overflow:hidden">
      <div style="padding:16px 24px;border-bottom:1px solid #E8ECF0"><h3 style="font-size:15px;font-weight:700;color:var(--oxford)">Actions rapides</h3></div>
      <div style="padding:16px">
        <button onclick="showPage('submit')" class="btn btn-primary" style="width:100%;margin-bottom:10px">+ Soumettre un nouveau risque</button>
        <button onclick="showPage('commissions')" class="btn btn-outline" style="width:100%;margin-bottom:16px">Relev√© de commissions</button>
        <div style="padding:16px;border-radius:12px;background:rgba(168,197,184,.12)">
          <p style="font-size:13px;font-weight:600;color:var(--oxford);margin-bottom:4px">üìã Renouvellement √† venir</p>
          <p style="font-size:12px;color:var(--cadet);margin-bottom:8px">Wind Song ‚Äî expire le 01/06/2025</p>
          <button onclick="showPage('policies')" style="font-size:12px;color:var(--lapis);font-weight:600;background:none;border:none;cursor:pointer;font-family:var(--fb)">Voir la police ‚Üí</button>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- SUBMIT RISK -->
<div id="page-submit" class="page-view">
  <h1 style="font-size:24px;font-weight:700;color:var(--oxford);font-family:var(--fd);margin-bottom:4px">Soumettre un risque</h1>
  <p style="font-size:14px;color:var(--cadet);margin-bottom:28px">Remplissez les informations de votre client pour recevoir des offres sous 48h.</p>
  <div class="card" style="padding:36px;max-width:800px">
    <div class="progress-bar"><div class="active" id="pb1"></div><div id="pb2"></div><div id="pb3"></div></div>
    <!-- Step 1: Owner -->
    <div id="formStep1">
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:24px"><div style="width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--yale),var(--lapis));display:flex;align-items:center;justify-content:center;color:white;font-size:14px;font-weight:700">1</div><span style="font-size:17px;font-weight:700;color:var(--oxford)">Propri√©taire / Assur√©</span></div>
      <div class="form-grid">
        <div class="full"><label class="form-label">Nom de l'assur√© *</label><input class="form-input" placeholder="Personne physique ou soci√©t√©"></div>
        <div class="full"><label class="form-label">Adresse *</label><input class="form-input"></div>
        <div><label class="form-label">Ville *</label><input class="form-input"></div>
        <div><label class="form-label">Pays *</label><input class="form-input"></div>
        <div class="full" style="margin-top:16px;padding-top:16px;border-top:1px solid #E8ECF0"><p style="font-size:14px;font-weight:700;color:var(--oxford)">B√©n√©ficiaire effectif (UBO)</p></div>
        <div><label class="form-label">Nom & Pr√©nom *</label><input class="form-input"></div>
        <div><label class="form-label">Date de naissance *</label><input class="form-input" type="date"></div>
        <div><label class="form-label">Nationalit√© *</label><input class="form-input"></div>
        <div><label class="form-label">Email client *</label><input class="form-input" type="email"></div>
      </div>
      <div style="display:flex;justify-content:flex-end;margin-top:28px;padding-top:20px;border-top:1px solid #E8ECF0"><button class="btn btn-primary" onclick="goFormStep(2)">Suivant ‚Üí Le navire</button></div>
    </div>
    <!-- Step 2: Vessel with OCR -->
    <div id="formStep2" style="display:none">
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:24px"><div style="width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--yale),var(--lapis));display:flex;align-items:center;justify-content:center;color:white;font-size:14px;font-weight:700">2</div><span style="font-size:17px;font-weight:700;color:var(--oxford)">Le navire</span></div>
      <div class="ocr-zone" id="ocrZone" onclick="document.getElementById('ocrInput').click()" ondragover="event.preventDefault();this.classList.add('dragover')" ondragleave="this.classList.remove('dragover')" ondrop="event.preventDefault();this.classList.remove('dragover');handleOCR(event.dataTransfer.files[0])">
        <input type="file" id="ocrInput" accept=".pdf,.jpg,.jpeg,.png" style="display:none" onchange="if(this.files[0])handleOCR(this.files[0])">
        <div id="ocrIdle"><div style="font-size:36px;margin-bottom:8px">üìÑ</div><p style="font-size:15px;font-weight:700;color:var(--oxford);margin-bottom:4px">Glissez un Certificate of Registry ici</p><p style="font-size:13px;color:var(--cadet);margin-bottom:12px">PDF, JPG ou PNG ‚Äî Les champs seront pr√©-remplis automatiquement</p><span style="display:inline-block;padding:8px 20px;border-radius:10px;background:linear-gradient(135deg,var(--yale),var(--lapis));color:white;font-size:13px;font-weight:600">Parcourir les fichiers</span></div>
        <div id="ocrLoading" style="display:none"><div class="spinner" style="margin:0 auto 8px"></div><p style="font-size:14px;font-weight:600;color:var(--yale)">Extraction des donn√©es du navire...</p></div>
        <div id="ocrDone" style="display:none"><p style="font-size:14px;font-weight:700;color:var(--green)" id="ocrResult"></p><p style="font-size:12px;color:var(--cadet);margin-top:4px">V√©rifiez les donn√©es ci-dessous et compl√©tez si n√©cessaire</p><button onclick="event.stopPropagation();resetOCR()" style="margin-top:8px;padding:4px 12px;border-radius:8px;border:1px solid #E2E8F0;background:white;font-size:12px;color:var(--cadet);cursor:pointer;font-family:var(--fb)">R√©initialiser</button></div>
        <div id="ocrError" style="display:none"><span style="font-size:14px;color:var(--red)">Erreur de lecture.</span> <button onclick="event.stopPropagation();resetOCR()" style="padding:4px 12px;border-radius:8px;border:1px solid #E2E8F0;background:white;font-size:12px;cursor:pointer;font-family:var(--fb)">R√©essayer</button></div>
      </div>
      <div id="ocrSep" style="display:flex;align-items:center;gap:16px;margin-bottom:24px"><div style="flex:1;height:1px;background:#E2E8F0"></div><span style="font-size:12px;font-weight:600;color:var(--cadet)">OU REMPLIR MANUELLEMENT</span><div style="flex:1;height:1px;background:#E2E8F0"></div></div>
      <div class="form-grid">
        <div><label class="form-label">Nom du navire *</label><input class="form-input" id="v_name"></div>
        <div><label class="form-label">Type *</label><select class="form-input" id="v_type"><option value="">...</option><option>Motor Yacht</option><option>Sailing Yacht</option></select></div>
        <div><label class="form-label">Constructeur *</label><input class="form-input" id="v_builder" placeholder="Benetti Oasis 40m"></div>
        <div><label class="form-label">Ann√©e *</label><input class="form-input" id="v_year" placeholder="2021"></div>
        <div><label class="form-label">Longueur (m) *</label><input class="form-input" id="v_length" placeholder="32"></div>
        <div><label class="form-label">Largeur (m)</label><input class="form-input" id="v_beam"></div>
        <div><label class="form-label">Pavillon *</label><input class="form-input" id="v_flag"></div>
        <div><label class="form-label">Mat√©riau coque *</label><select class="form-input" id="v_material"><option value="">...</option><option>GRP / Fiberglass</option><option>Steel</option><option>Aluminum</option><option>Wood</option><option>Carbon / Composite</option></select></div>
        <div><label class="form-label">Jauge brute (GT)</label><input class="form-input" id="v_tonnage"></div>
        <div><label class="form-label">IMO / Official Number</label><input class="form-input" id="v_imo"></div>
        <div><label class="form-label">Port d'immatriculation</label><input class="form-input" id="v_portRegistry"></div>
        <div><label class="form-label">Port d'attache *</label><input class="form-input" id="v_homePort"></div>
        <div><label class="form-label">Valeur (‚Ç¨) *</label><input class="form-input" id="v_value" placeholder="2,800,000"></div>
        <div><label class="form-label">Capacit√© passagers</label><input class="form-input" id="v_passengers"></div>
        <div class="full"><label class="form-label">Moteurs</label><input class="form-input" id="v_engines" placeholder="2x CAT C32 ACERT, 2x 1925HP"></div>
      </div>
      <div style="display:flex;justify-content:space-between;margin-top:28px;padding-top:20px;border-top:1px solid #E8ECF0"><button class="btn btn-secondary" onclick="goFormStep(1)">‚Üê Propri√©taire</button><button class="btn btn-primary" onclick="goFormStep(3)">Suivant ‚Üí Usage</button></div>
    </div>
    <!-- Step 3: Usage -->
    <div id="formStep3" style="display:none">
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:24px"><div style="width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--yale),var(--lapis));display:flex;align-items:center;justify-content:center;color:white;font-size:14px;font-weight:700">3</div><span style="font-size:17px;font-weight:700;color:var(--oxford)">Usage, couvertures & √©quipage</span></div>
      <div class="form-grid">
        <div class="full"><label class="form-label">Zone de navigation *</label><input class="form-input" placeholder="M√©diterran√©e, Cara√Øbes..."></div>
        <div class="full"><label class="form-label">Usage *</label><div style="display:flex;gap:10px;flex-wrap:wrap"><label style="display:flex;align-items:center;gap:6px;padding:8px 16px;border-radius:10px;border:1px solid #E2E8F0;font-size:13px;cursor:pointer"><input type="radio" name="use">Private & Pleasure</label><label style="display:flex;align-items:center;gap:6px;padding:8px 16px;border-radius:10px;border:1px solid #E2E8F0;font-size:13px;cursor:pointer"><input type="radio" name="use">Skipper Charter</label><label style="display:flex;align-items:center;gap:6px;padding:8px 16px;border-radius:10px;border:1px solid #E2E8F0;font-size:13px;cursor:pointer"><input type="radio" name="use">Autre</label></div></div>
        <div class="full"><label class="form-label">Couvertures</label><div style="display:flex;gap:8px;flex-wrap:wrap"><label style="display:flex;align-items:center;gap:6px;padding:8px 16px;border-radius:10px;border:1px solid #E2E8F0;font-size:13px;cursor:pointer"><input type="checkbox" checked>Hull & Machinery</label><label style="display:flex;align-items:center;gap:6px;padding:8px 16px;border-radius:10px;border:1px solid #E2E8F0;font-size:13px;cursor:pointer"><input type="checkbox" checked>P&I</label><label style="display:flex;align-items:center;gap:6px;padding:8px 16px;border-radius:10px;border:1px solid #E2E8F0;font-size:13px;cursor:pointer"><input type="checkbox">Crew</label></div></div>
        <div><label class="form-label">Sports nautiques ?</label><div style="display:flex;gap:8px"><label style="display:flex;align-items:center;gap:6px;padding:8px 16px;border-radius:10px;border:1px solid #E2E8F0;font-size:13px;cursor:pointer"><input type="radio" name="ws">Oui</label><label style="display:flex;align-items:center;gap:6px;padding:8px 16px;border-radius:10px;border:1px solid #E2E8F0;font-size:13px;cursor:pointer"><input type="radio" name="ws" checked>Non</label></div></div>
        <div><label class="form-label">R√©gate ?</label><div style="display:flex;gap:8px"><label style="display:flex;align-items:center;gap:6px;padding:8px 16px;border-radius:10px;border:1px solid #E2E8F0;font-size:13px;cursor:pointer"><input type="radio" name="race">Oui</label><label style="display:flex;align-items:center;gap:6px;padding:8px 16px;border-radius:10px;border:1px solid #E2E8F0;font-size:13px;cursor:pointer"><input type="radio" name="race" checked>Non</label></div></div>
        <div><label class="form-label">√âquipage permanent</label><input class="form-input" placeholder="4"></div>
        <div><label class="form-label">√âquipage temporaire</label><input class="form-input" placeholder="2"></div>
        <div class="full"><label class="form-label">Sinistres (5 derni√®res ann√©es)</label><textarea class="form-input" rows="2" placeholder="D√©taillez le cas √©ch√©ant..."></textarea></div>
        <div class="full"><label class="form-label">Notes</label><textarea class="form-input" rows="2" placeholder="Couverture existante, renouvellement..."></textarea></div>
      </div>
      <div style="display:flex;justify-content:space-between;margin-top:28px;padding-top:20px;border-top:1px solid #E8ECF0"><button class="btn btn-secondary" onclick="goFormStep(2)">‚Üê Le navire</button><button class="btn btn-primary" onclick="submitRisk()">Envoyer la demande ‚Üí</button></div>
    </div>
    <!-- Success -->
    <div id="formSuccess" style="display:none;text-align:center;padding:60px 0">
      <div style="width:64px;height:64px;border-radius:50%;background:rgba(168,197,184,.2);display:flex;align-items:center;justify-content:center;margin:0 auto 20px;font-size:28px">‚úì</div>
      <h2 style="font-size:24px;font-weight:700;color:var(--oxford);font-family:var(--fd);margin-bottom:8px">Risque soumis avec succ√®s</h2>
      <p style="font-size:15px;color:var(--cadet);max-width:400px;margin:0 auto 24px">Votre demande a √©t√© envoy√©e. Vous recevrez les premi√®res offres sous 48h.</p>
      <p style="font-size:14px;font-weight:600;color:var(--yale);margin-bottom:24px">R√©f√©rence : QR-2025-0034</p>
      <button class="btn btn-primary" onclick="resetSubmitForm()">Soumettre un autre risque</button>
    </div>
  </div>
</div>
<!-- QUOTES -->
<div id="page-quotes" class="page-view">
  <div id="quotesList">
    <h1 style="font-size:24px;font-weight:700;color:var(--oxford);font-family:var(--fd);margin-bottom:4px">Mes demandes de devis</h1>
    <p style="font-size:14px;color:var(--cadet);margin-bottom:28px">Suivez l'avancement de vos soumissions et comparez les offres re√ßues.</p>
    <div class="card" style="overflow-x:auto">
      <table><thead><tr><th>R√©f√©rence</th><th>Navire</th><th>Propri√©taire</th><th>Valeur</th><th>Statut</th><th>Offres</th><th></th></tr></thead>
      <tbody>
        <tr class="clickable" onclick="showQuoteDetail()"><td style="font-weight:600;color:var(--lapis)">QR-2025-0012</td><td><strong style="color:var(--oxford)">Azure Dream</strong><br><span style="font-size:12px;color:var(--cadet)">Motor Yacht ¬∑ 32m</span></td><td>Laurent Mercier</td><td style="font-weight:600">‚Ç¨4,200,000</td><td><span class="badge badge-quoted">Offres re√ßues</span></td><td style="font-weight:600;color:var(--green)">3</td><td style="color:var(--cadet)">‚Üí</td></tr>
        <tr class="clickable"><td style="font-weight:600;color:var(--lapis)">QR-2025-0018</td><td><strong style="color:var(--oxford)">Stella Maris</strong><br><span style="font-size:12px;color:var(--cadet)">Sailing Yacht ¬∑ 24m</span></td><td>Sophie Renard</td><td style="font-weight:600">‚Ç¨1,800,000</td><td><span class="badge badge-submitted">Envoy√©</span></td><td style="color:var(--cadet)">0</td><td style="color:var(--cadet)">‚Üí</td></tr>
        <tr class="clickable"><td style="font-weight:600;color:var(--lapis)">QR-2025-0023</td><td><strong style="color:var(--oxford)">Poseidon IV</strong><br><span style="font-size:12px;color:var(--cadet)">Motor Yacht ¬∑ 45m</span></td><td>Konstantin Volkov</td><td style="font-weight:600">‚Ç¨12,500,000</td><td><span class="badge badge-bound">Souscrit</span></td><td style="font-weight:600;color:var(--green)">1</td><td style="color:var(--cadet)">‚Üí</td></tr>
        <tr class="clickable"><td style="font-weight:600;color:var(--lapis)">QR-2025-0027</td><td><strong style="color:var(--oxford)">Calypso</strong><br><span style="font-size:12px;color:var(--cadet)">Motor Yacht ¬∑ 28m</span></td><td>Isabella Fontana</td><td style="font-weight:600">‚Ç¨3,100,000</td><td><span class="badge badge-quoting">En cotation</span></td><td style="font-weight:600;color:var(--green)">1</td><td style="color:var(--cadet)">‚Üí</td></tr>
      </tbody></table>
    </div>
  </div>
  <div id="quoteDetail" style="display:none">
    <button onclick="document.getElementById('quoteDetail').style.display='none';document.getElementById('quotesList').style.display='block'" style="background:none;border:none;color:var(--cadet);font-size:13px;cursor:pointer;margin-bottom:20px;font-family:var(--fb)">‚Üê Retour aux demandes</button>
    <div style="display:flex;align-items:center;gap:16px;margin-bottom:28px"><h1 style="font-size:24px;font-weight:700;color:var(--oxford);font-family:var(--fd)">Azure Dream</h1><span class="badge badge-quoted">Offres re√ßues</span></div>
    <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:28px">
      <div class="card" style="padding:16px"><p style="font-size:11px;color:var(--cadet);text-transform:uppercase;letter-spacing:.05em;font-weight:600;margin-bottom:2px">R√©f.</p><p style="font-size:15px;font-weight:700;color:var(--oxford)">QR-2025-0012</p></div>
      <div class="card" style="padding:16px"><p style="font-size:11px;color:var(--cadet);text-transform:uppercase;letter-spacing:.05em;font-weight:600;margin-bottom:2px">Type</p><p style="font-size:15px;font-weight:700;color:var(--oxford)">Motor Yacht</p></div>
      <div class="card" style="padding:16px"><p style="font-size:11px;color:var(--cadet);text-transform:uppercase;letter-spacing:.05em;font-weight:600;margin-bottom:2px">LOA</p><p style="font-size:15px;font-weight:700;color:var(--oxford)">32m</p></div>
      <div class="card" style="padding:16px"><p style="font-size:11px;color:var(--cadet);text-transform:uppercase;letter-spacing:.05em;font-weight:600;margin-bottom:2px">Valeur</p><p style="font-size:15px;font-weight:700;color:var(--oxford)">‚Ç¨4,200,000</p></div>
    </div>
    <h3 style="font-size:17px;font-weight:700;color:var(--oxford);margin-bottom:16px">Offres re√ßues (3)</h3>
    <!-- Recommended -->
    <div style="position:relative;background:white;border-radius:16px;border:2px solid var(--opal);padding:24px;display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;flex-wrap:wrap;gap:16px"><div style="position:absolute;top:-1px;right:20px;background:var(--opal);color:white;font-size:11px;font-weight:700;padding:3px 12px;border-radius:0 0 8px 8px">‚òÖ Recommand√©</div><div><p style="font-size:16px;font-weight:700;color:var(--oxford);margin-bottom:4px">Pantaenius</p><span class="badge badge-received">Re√ßue</span></div><div style="display:flex;gap:32px;align-items:center;flex-wrap:wrap"><div style="text-align:right"><p style="font-size:11px;color:var(--cadet);margin-bottom:2px">Prime</p><p style="font-size:20px;font-weight:700;color:var(--lapis);font-family:var(--fd)">‚Ç¨39,800</p></div><div style="text-align:right"><p style="font-size:11px;color:var(--cadet);margin-bottom:2px">Franchise</p><p style="font-size:15px;font-weight:600">‚Ç¨20,000</p></div><div style="text-align:right"><p style="font-size:11px;color:var(--cadet);margin-bottom:2px">Votre commission</p><p style="font-size:15px;font-weight:600;color:var(--green)">‚Ç¨3,980</p></div></div></div>
    <div style="background:white;border-radius:16px;border:1px solid #E8ECF0;padding:24px;display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;flex-wrap:wrap;gap:16px"><div><p style="font-size:16px;font-weight:700;color:var(--oxford);margin-bottom:4px">Zurich Marine</p><span class="badge badge-received">Re√ßue</span></div><div style="display:flex;gap:32px;align-items:center;flex-wrap:wrap"><div style="text-align:right"><p style="font-size:11px;color:var(--cadet);margin-bottom:2px">Prime</p><p style="font-size:20px;font-weight:700;color:var(--oxford);font-family:var(--fd)">‚Ç¨47,500</p></div><div style="text-align:right"><p style="font-size:11px;color:var(--cadet);margin-bottom:2px">Franchise</p><p style="font-size:15px;font-weight:600">‚Ç¨25,000</p></div><div style="text-align:right"><p style="font-size:11px;color:var(--cadet);margin-bottom:2px">Votre commission</p><p style="font-size:15px;font-weight:600;color:var(--green)">‚Ç¨4,750</p></div></div></div>
    <div style="background:white;border-radius:16px;border:1px solid #E8ECF0;padding:24px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px"><div><p style="font-size:16px;font-weight:700;color:var(--oxford);margin-bottom:4px">Beazley</p><span class="badge badge-received">Re√ßue</span></div><div style="display:flex;gap:32px;align-items:center;flex-wrap:wrap"><div style="text-align:right"><p style="font-size:11px;color:var(--cadet);margin-bottom:2px">Prime</p><p style="font-size:20px;font-weight:700;color:var(--oxford);font-family:var(--fd)">‚Ç¨52,100</p></div><div style="text-align:right"><p style="font-size:11px;color:var(--cadet);margin-bottom:2px">Franchise</p><p style="font-size:15px;font-weight:600">‚Ç¨30,000</p></div><div style="text-align:right"><p style="font-size:11px;color:var(--cadet);margin-bottom:2px">Votre commission</p><p style="font-size:15px;font-weight:600;color:var(--green)">‚Ç¨5,210</p></div></div></div>
  </div>
</div>

<!-- POLICIES -->
<div id="page-policies" class="page-view">
  <h1 style="font-size:24px;font-weight:700;color:var(--oxford);font-family:var(--fd);margin-bottom:4px">Polices d'assurance</h1>
  <p style="font-size:14px;color:var(--cadet);margin-bottom:28px">Polices actives de vos clients plac√©es via Blue Cover.</p>
  <div style="display:grid;gap:16px">
    <div class="card" style="padding:24px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px"><div style="min-width:200px"><p style="font-size:15px;font-weight:700;color:var(--oxford);margin-bottom:2px">Poseidon IV</p><p style="font-size:12px;color:var(--cadet)">POL-2024-0045 ¬∑ Howden (Lloyd's)</p></div><div><p style="font-size:11px;color:var(--cadet)">Prime</p><p style="font-size:14px;font-weight:700;color:var(--oxford)">‚Ç¨142,000</p></div><div><p style="font-size:11px;color:var(--cadet)">Commission</p><p style="font-size:14px;font-weight:700;color:var(--green)">‚Ç¨14,200</p></div><div><p style="font-size:11px;color:var(--cadet)">√âch√©ance</p><p style="font-size:13px;font-weight:600">01/12/2025</p></div><div><span class="badge badge-active">Active</span></div></div>
    <div class="card" style="padding:24px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px"><div style="min-width:200px"><p style="font-size:15px;font-weight:700;color:var(--oxford);margin-bottom:2px">Nereus</p><p style="font-size:12px;color:var(--cadet)">POL-2024-0031 ¬∑ Pantaenius</p></div><div><p style="font-size:11px;color:var(--cadet)">Prime</p><p style="font-size:14px;font-weight:700;color:var(--oxford)">‚Ç¨28,400</p></div><div><p style="font-size:11px;color:var(--cadet)">Commission</p><p style="font-size:14px;font-weight:700;color:var(--green)">‚Ç¨2,840</p></div><div><p style="font-size:11px;color:var(--cadet)">√âch√©ance</p><p style="font-size:13px;font-weight:600">15/09/2025</p></div><div><span class="badge badge-active">Active</span></div></div>
    <div class="card" style="padding:24px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px"><div style="min-width:200px"><p style="font-size:15px;font-weight:700;color:var(--oxford);margin-bottom:2px">Wind Song</p><p style="font-size:12px;color:var(--cadet)">POL-2024-0022 ¬∑ Zurich Marine</p></div><div><p style="font-size:11px;color:var(--cadet)">Prime</p><p style="font-size:14px;font-weight:700;color:var(--oxford)">‚Ç¨18,900</p></div><div><p style="font-size:11px;color:var(--cadet)">Commission</p><p style="font-size:14px;font-weight:700;color:var(--green)">‚Ç¨1,890</p></div><div><p style="font-size:11px;color:var(--cadet)">√âch√©ance</p><p style="font-size:13px;font-weight:600">01/06/2025</p></div><div><span class="badge badge-renewal">Renouvellement</span></div></div>
  </div>
</div>

<!-- COMMISSIONS -->
<div id="page-commissions" class="page-view">
  <h1 style="font-size:24px;font-weight:700;color:var(--oxford);font-family:var(--fd);margin-bottom:4px">Suivi des commissions</h1>
  <p style="font-size:14px;color:var(--cadet);margin-bottom:28px">D√©tail de vos commissions sur les polices plac√©es via Blue Cover.</p>
  <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-bottom:28px">
    <div class="card" style="padding:24px"><p style="font-size:13px;color:var(--cadet);margin-bottom:4px">Total 2024-2025</p><p style="font-size:28px;font-weight:700;color:var(--oxford);font-family:var(--fd)">‚Ç¨18,930</p></div>
    <div class="card" style="padding:24px"><p style="font-size:13px;color:var(--cadet);margin-bottom:4px">Pay√©</p><p style="font-size:28px;font-weight:700;color:var(--green);font-family:var(--fd)">‚Ç¨17,040</p></div>
    <div class="card" style="padding:24px"><p style="font-size:13px;color:var(--cadet);margin-bottom:4px">En attente</p><p style="font-size:28px;font-weight:700;color:var(--amber);font-family:var(--fd)">‚Ç¨1,890</p></div>
  </div>
  <div class="card" style="overflow-x:auto">
    <table><thead><tr><th>R√©f.</th><th>Police</th><th>Navire</th><th>Taux</th><th>Montant</th><th>P√©riode</th><th>Statut</th><th>Paiement</th></tr></thead>
    <tbody>
      <tr><td style="font-weight:600;color:var(--lapis)">COM-001</td><td>POL-2024-0045</td><td style="font-weight:600;color:var(--oxford)">Poseidon IV</td><td>10%</td><td style="font-weight:700;color:var(--green)">‚Ç¨14,200</td><td>2024-2025</td><td><span class="badge badge-paid">Pay√©</span></td><td>15/01/2025</td></tr>
      <tr><td style="font-weight:600;color:var(--lapis)">COM-002</td><td>POL-2024-0031</td><td style="font-weight:600;color:var(--oxford)">Nereus</td><td>10%</td><td style="font-weight:700;color:var(--green)">‚Ç¨2,840</td><td>2024-2025</td><td><span class="badge badge-paid">Pay√©</span></td><td>15/01/2025</td></tr>
      <tr><td style="font-weight:600;color:var(--lapis)">COM-003</td><td>POL-2024-0022</td><td style="font-weight:600;color:var(--oxford)">Wind Song</td><td>10%</td><td style="font-weight:700;color:var(--amber)">‚Ç¨1,890</td><td>2024-2025</td><td><span class="badge badge-pending">En attente</span></td><td>‚Äî</td></tr>
    </tbody></table>
  </div>
  <p style="font-size:12px;color:#94A3B8;margin-top:16px">Commissions √† 10% de la prime nette, vers√©es trimestriellement. Questions : hello@bluecover.ch</p>
</div>

</div><!-- /mainContent -->
</div><!-- /appPage -->
<script>
function doLogin(e){if(e)e.preventDefault();document.getElementById('loginPage').style.display='none';document.getElementById('appPage').style.display='block';}
function doLogout(){document.getElementById('appPage').style.display='none';document.getElementById('loginPage').style.display='flex';}

function showPage(id){
  document.querySelectorAll('.page-view').forEach(function(p){p.style.display='none';});
  document.getElementById('page-'+id).style.display='block';
  document.querySelectorAll('.nav-item').forEach(function(n){n.classList.remove('active');});
  document.querySelector('.nav-item[data-page="'+id+'"]').classList.add('active');
  if(id==='quotes'){document.getElementById('quotesList').style.display='block';document.getElementById('quoteDetail').style.display='none';}
}

function showQuoteDetail(){document.getElementById('quotesList').style.display='none';document.getElementById('quoteDetail').style.display='block';}

function goFormStep(n){
  document.getElementById('formStep1').style.display=n===1?'block':'none';
  document.getElementById('formStep2').style.display=n===2?'block':'none';
  document.getElementById('formStep3').style.display=n===3?'block':'none';
  document.getElementById('formSuccess').style.display='none';
  document.getElementById('pb1').className=n>=1?'active':'';
  document.getElementById('pb2').className=n>=2?'active':'';
  document.getElementById('pb3').className=n>=3?'active':'';
}

function submitRisk(){
  document.getElementById('formStep1').style.display='none';
  document.getElementById('formStep2').style.display='none';
  document.getElementById('formStep3').style.display='none';
  document.getElementById('formSuccess').style.display='block';
  document.querySelector('.progress-bar').style.display='none';
}

function resetSubmitForm(){
  document.querySelector('.progress-bar').style.display='flex';
  goFormStep(1);
  resetOCR();
}

// OCR
function resetOCR(){
  document.getElementById('ocrIdle').style.display='block';
  document.getElementById('ocrLoading').style.display='none';
  document.getElementById('ocrDone').style.display='none';
  document.getElementById('ocrError').style.display='none';
  document.getElementById('ocrSep').style.display='flex';
  document.getElementById('ocrZone').style.cursor='pointer';
  var fields=['v_name','v_type','v_builder','v_year','v_length','v_beam','v_flag','v_material','v_tonnage','v_imo','v_portRegistry','v_homePort','v_value','v_passengers','v_engines'];
  fields.forEach(function(id){var el=document.getElementById(id);if(el){el.value='';el.classList.remove('highlight');}});
}

async function handleOCR(file){
  if(!file)return;
  document.getElementById('ocrIdle').style.display='none';
  document.getElementById('ocrLoading').style.display='block';
  document.getElementById('ocrSep').style.display='none';
  document.getElementById('ocrZone').style.cursor='default';

  try{
    var base64=await new Promise(function(resolve,reject){
      var reader=new FileReader();
      reader.onload=function(){resolve(reader.result.split(',')[1]);};
      reader.onerror=function(){reject('read error');};
      reader.readAsDataURL(file);
    });

    var mediaType=file.type==='application/pdf'?'application/pdf':file.type.startsWith('image/')?file.type:'application/pdf';
    var contentBlock=mediaType==='application/pdf'
      ?{type:"document",source:{type:"base64",media_type:"application/pdf",data:base64}}
      :{type:"image",source:{type:"base64",media_type:mediaType,data:base64}};

    var resp=await fetch("https://api.anthropic.com/v1/messages",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({
        model:"claude-sonnet-4-20250514",
        max_tokens:1000,
        messages:[{role:"user",content:[
          contentBlock,
          {type:"text",text:'Extract vessel data from this Certificate of Registry. Return ONLY a JSON object: {"name":"","type":"Motor Yacht or Sailing Yacht","flag":"","tonnage":"","imo":"","portRegistry":"","homePort":"","builder":"","year":"","length":"","beam":"","material":"GRP / Fiberglass or Steel or Aluminum or Wood or Carbon / Composite","engines":"","passengers":""}. Use empty string if not found. ONLY valid JSON, no markdown.'}
        ]}]
      })
    });

    var data=await resp.json();
    var text=data.content.map(function(c){return c.text||'';}).join('');
    var clean=text.replace(/```json|```/g,'').trim();
    var parsed=JSON.parse(clean);

    var mapping={name:'v_name',type:'v_type',builder:'v_builder',year:'v_year',length:'v_length',beam:'v_beam',flag:'v_flag',material:'v_material',tonnage:'v_tonnage',imo:'v_imo',portRegistry:'v_portRegistry',homePort:'v_homePort',passengers:'v_passengers',engines:'v_engines'};
    var count=0;
    for(var key in mapping){
      if(parsed[key]&&parsed[key].trim()){
        var el=document.getElementById(mapping[key]);
        if(el){el.value=parsed[key].trim();el.classList.add('highlight');count++;}
      }
    }

    document.getElementById('ocrLoading').style.display='none';
    document.getElementById('ocrDone').style.display='block';
    document.getElementById('ocrResult').textContent=file.name+' ‚Äî '+count+' champs pr√©-remplis';
    document.getElementById('ocrZone').classList.add('highlight');

  }catch(err){
    console.error('OCR error:',err);
    document.getElementById('ocrLoading').style.display='none';
    document.getElementById('ocrError').style.display='block';
  }
}
</script>
</body>
</html>
